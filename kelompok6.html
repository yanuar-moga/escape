<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Kata Misteri - Kelompok 1</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js"></script>

<style>
body{
  font-family:Arial, sans-serif;
  background:#0d1b2a;
  color:white;
  text-align:center;
}
#soalBox{
  background:#1b263b;
  padding:20px;
  max-width:450px;
  margin:auto;
  border-radius:12px;
  margin-top:30px;
}
input{
  width:260px;
  padding:10px;
  border:none;
  border-radius:6px;
  margin:10px;
}
#timer{
  font-size:22px;
  font-weight:bold;
  background:#ff4747;
  display:inline-block;
  padding:5px 12px;
  border-radius:8px;
  margin-bottom:10px;
}
#popUp{
  position:fixed;
  top:-200px;
  left:50%;
  transform:translateX(-50%);
  background:#ffe45c;
  color:#000;
  padding:20px;
  border-radius:12px;
  width:260px;
  font-size:20px;
  transition:.5s;
}
#win{
  display:none;
  margin-top:30px;
  font-size:28px;
  color:#0f0;
}
</style>
</head>
<body>

<h2>Kelompok 6 âœ…</h2>
<div id="timer">30</div>

<div id="soalBox">
  <h3 id="soalText">Memuat soal...</h3>
  <input id="jawaban" placeholder="Ketik jawaban..." autocomplete="off">
  <br>
  <button onclick="cekJawaban()">Kirim Jawaban</button>
</div>

<div id="popUp"></div>
<div id="win">ðŸŽ‰ SELAMAT! Kamu menemukan semua kata rahasia! ðŸŽ‰</div>

<audio id="benarSound" src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3"></audio>
<audio id="salahSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>

<script>
// ---------- FIREBASE CONFIG ----------
const firebaseConfig = {
  apiKey: "AIzaSyBr-nd0dxZl5q6DLPxMKLybJ7MyBc9kaBc",
  authDomain: "realtime-database-f59b8.firebaseapp.com",
  databaseURL: "https://realtime-database-f59b8-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "realtime-database-f59b8",
  storageBucket: "realtime-database-f59b8.appspot.com",
  messagingSenderId: "320982155387",
  appId: "1:320982155387:web:df67817761e282dee4a2de"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ---------- GAME ----------
let kata = [];
let index = 0; 
let waktu = 30;
let timer;

db.ref("kata_misteri").once("value").then(snap=>{
    kata = snap.val();
    if(!kata || kata.length < 1){
        document.getElementById("soalText").innerHTML = "âŒ Belum ada soal di database.";
        return;
    }
    tampilSoal();
    mulaiTimer();
});

function tampilSoal(){
    document.getElementById("soalText").innerHTML = `Kata Rahasia Ke-${index+1}`;
}

function mulaiTimer(){
    timer = setInterval(()=>{
        waktu--;
        document.getElementById("timer").innerText = waktu;
        if(waktu === 0){
            salah();
        }
    },1000);
}

function cekJawaban(){
    let jawaban = document.getElementById("jawaban").value.toLowerCase().trim();
    if(jawaban === kata[index]){
        benar();
    } else {
        salah();
    }
}

function benar(){
    clearInterval(timer);
    document.getElementById("benarSound").play();
    pop(`Huruf Misteri: <b>${kata[index][0].toUpperCase()}</b>`);

    index++;
    if(index >= kata.length){
        menang();
        return;
    }

    document.getElementById("jawaban").value = "";
    waktu = 30;
    mulaiTimer();
    tampilSoal();
}

function salah(){
    clearInterval(timer);
    document.getElementById("salahSound").play();
    pop("âŒ Salah, kembali ke soal sebelumnya!");

    index = Math.max(0, index - 1);
    document.getElementById("jawaban").value = "";
    waktu = 30;
    mulaiTimer();
    tampilSoal();
}

function pop(msg){
    let p = document.getElementById("popUp");
    p.innerHTML = msg;
    p.style.top = "20px";
    setTimeout(()=>{ p.style.top = "-200px"; },2000);
}

function menang(){
    document.getElementById("soalBox").style.display = "none";
    document.getElementById("win").style.display = "block";
}
</script>

</body>
</html>
