<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin – Upload Soal</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js"></script>

<style>
body{
  font-family:Arial;
  background:#eef6ff;
  text-align:center;
  padding:20px;
}
.box{
  background:white;
  padding:20px;
  border-radius:10px;
  max-width:400px;
  margin:auto;
  box-shadow:0 3px 10px rgba(0,0,0,.2);
}
input,button{
  padding:10px;
  border-radius:6px;
  border:1px solid #ccc;
  width:100%;
  margin-bottom:10px;
}
button{
  background:#007bff;
  color:#fff;
  border:none;
}
</style>
</head>
<body>

<h2>Admin Panel Upload Soal</h2>

<div class="box">
  <input type="file" id="fileExcel" accept=".xlsx, .xls">
  <button onclick="uploadExcel()">Upload Soal</button>
  <p id="status"></p>
</div>

<script>
// ---- Firebase ---------------------------------
const firebaseConfig = {
  apiKey: "AIzaSyBr-nd0dxZl5q6DLPxMKLybJ7MyBc9kaBc",
  authDomain: "realtime-database-f59b8.firebaseapp.com",
  databaseURL: "https://realtime-database-f59b8-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "realtime-database-f59b8",
  storageBucket: "realtime-database-f59b8.appspot.com",
  messagingSenderId: "320982155387",
  appId: "1:320982155387:web:df67817761e282dee4a2de"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ---- Upload Excel ---------------------------------
function uploadExcel(){
  let file = document.getElementById("fileExcel").files[0];
  if(!file){
    alert("Pilih file Excel dulu!");
    return;
  }

  let reader = new FileReader();
  reader.onload = function(e){
    let data = new Uint8Array(e.target.result);
    let workbook = XLSX.read(data, { type: "array" });
    let sheetName = workbook.SheetNames[0];
    let sheet = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);

    let kata = [];
    sheet.forEach(row=>{
      kata.push(row.soal.toLowerCase());
    });

    firebase.database().ref("kata_misteri").set(kata)
    .then(()=>{
      document.getElementById("status").innerHTML = "✅ Upload berhasil! Soal tersimpan di database.";
    });
  };
  reader.readAsArrayBuffer(file);
}
</script>

</body>
</html>
